<template>
  <a-config-provider :locale="locale.current">
    <a-layout class="c-container">
      <a-layout>
        <a-layout-sider class="c-aside" collapsible>
          <a-menu :default-selected-keys="[menu.current]">
            <c-menu v-model="menu.items"></c-menu>
          </a-menu>
        </a-layout-sider>
        <a-layout class="c-main">
          <a-layout-header>
            <a-space>
              <c-icon :name="dark?'icon-moon':'icon-sun'" @click="changeTheme"></c-icon>
              <a-dropdown trigger="hover">
                <a-button>{{locale.current.locale}}</a-button>
                <template #content>
                  <a-doption v-for="item in locale.items" @click="changeLocale(item)">{{item.locale}}</a-doption>
                </template>
              </a-dropdown>
            </a-space>
          </a-layout-header>
          <a-layout-content>
            <slot></slot>
          </a-layout-content>
          <a-layout-footer>Footer</a-layout-footer>
          <a-back-top target-container=".arco-layout-content" :style="{position:'absolute'}" />
        </a-layout>
      </a-layout>
    </a-layout>
  </a-config-provider>
</template>
<script>
  import zhCN from "https://cdn.jsdelivr.net/npm/@arco-design/web-vue@2.3.0/es/locale/lang/zh-cn.js";
  import enUS from "https://cdn.jsdelivr.net/npm/@arco-design/web-vue@2.3.0/es/locale/lang/en-us.js";

  export default {
    data() {
      return {
        title: "Arch Design Vue",
        dark: false,
        collapsed: false,
        locale: {
          current: zhCN,
          items: [zhCN, enUS]
        },
        menu: {
          current: '/',
          items: []
        }
      }
    },
    mounted() {
      document.title = this.name + "|" + this.title;
      this.menu.items = this.init();
    },
    methods:
    {
      init() {
        fetch("api/menu.json")
          .then((o) => o.json())
          .then((o) => (this.menu.items = o));
      },
      onCollapse() {
        this.collapsed = !this.collapsed;
      },
      changeLocale(item) {
        this.locale.current = item;
      },
      changeTheme() {
        this.dark = !this.dark;
        if (this.dark) {
          document.body.setAttribute('arco-theme', 'dark');
        }
        else {
          document.body.removeAttribute('arco-theme');
        }
      }
    }
  };
</script>
<style>
  body,
  body>div,
  .c-container {
    margin: 0;
    padding: 0;
    height: 100vh;
    background-color: var(--color-bg-1);
  }

  .arco-icon {
    color: var(--color-text-1);
  }

  .arco-layout-sider-trigger {
    overflow-y: hidden;
  }

  .arco-layout-header,
  .arco-layout-footer {
    height: 60px;
  }
</style>